{% extends "engine/base.html" %}
{% load i18n static %}

{% block content_engine %}
        <h2>
            {{ game.title }}
            {% if game.author %}
                <small>
                    {% blocktrans with author=game.author %}by {{ author }}{% endblocktrans %}
                </small>
            {% endif %}
        </h2>
        <p>
            {% block game_menu %}
            <a href="{% url 'game_detail' game.id %}">{% trans "details" %}</a>
            | <a href="{% url 'game_play' game.id %}">{% trans "play" %}</a>
            | <a href="{% url 'game_ranking' game.id %}">{% trans "ranking" %}</a>
            {% endblock %}
        </p>
        <div>
            {% block content_game %}
                <p>{{ game.description|default:"No description available." }}</p>

                <h3>{% trans "Popularity" %}</h3>
                <div class="col-xs-12">
                    <div id="game-stats"></div>
                </div>
            {% endblock %}
        </div>


{% endblock %}

{% block extra_js %}
            <script src="{% static 'js/dygraph-combined.js' %}"></script>
            <script>
                var drawGraphStats = function() {
                    new Dygraph(document.getElementById("game-stats"),
                        [
                        {% for date,anon,player in game_stats %}
                            [new Date("{{ date }}"), {{ anon }}, {{ player }}],
                        {% endfor %}
                        ],
                        {
                        legend: 'always',
                        drawPoints: false,
                        showRoller: false,
                        labels: ['{% trans "Date" %}', '{% trans "Anonymous" %}', '{% trans "Registered" %}']
                    });
                };

                $(document).ready(function(){
                    drawGraphStats();
                });
            </script>
{% endblock %}